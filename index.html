<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ad 4 U - Free & Paid Ad Service</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
  <!-- Google Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    body { margin: 0; font-family: Arial, sans-serif; background: #f9f9f9; }
    header { background: #2e7d32; color: #fff; padding: 20px 16px 10px 16px; }
    header h1 { margin: 0; font-size: 2em; letter-spacing: 2px; }
    nav { display: flex; gap: 10px; margin-top: 10px; }
    nav button { background: #fff; color: #2e7d32; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: bold;}
    nav button.active { background: #388e3c; color: #fff; }
    #userPanel { float: right; margin-top: -55px; }
    #userPanel span { font-weight: bold; margin-right: 15px;}
    #userPanel button { background: #fff; color: #2e7d32; border: none; border-radius: 3px; padding: 4px 10px; cursor: pointer;}
    .container { max-width: 1000px; margin: 30px auto; background: #fff; padding: 25px 20px; border-radius: 10px; box-shadow: 0 2px 10px #0001;}
    .hide { display: none; }
    .cards { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px;}
    .card { flex: 1; min-width: 200px; background: #e8f5e9; padding: 18px; border-radius: 6px; font-weight: bold; font-size: 1.1em;}
    .highlight { color: #d32f2f; font-weight: bold;}
    .iframe-container { border: 2px solid #388e3c; border-radius: 8px; margin: 18px 0; overflow: hidden; height: 300px; background: #222;}
    .iframe-container iframe { width: 100%; height: 100%; border: none;}
    .timer { font-size: 1.3em; font-weight: bold; margin: 12px 0;}
    .btn-action { background: #2e7d32; color: #fff; border: none; padding: 8px 18px; border-radius: 3px; font-weight: bold; cursor: pointer;}
    .btn-action:disabled { background: #90a4ae; }
    .input-group { margin: 12px 0; }
    label { font-weight: bold; }
    .input-group input, .input-group select { padding: 6px; margin-left: 8px; border-radius: 3px; border: 1px solid #aaa;}
    .ref-link { background: #f1f8e9; padding: 8px; border-radius: 4px; margin: 8px 0; word-break: break-all;}
    .comm-table { width: 100%; border-spacing: 0; }
    .comm-table th, .comm-table td { padding: 7px 10px; border-bottom: 1px solid #bbb;}
    .comm-table th { background: #e0e0e0; }
    .comm-table td { background: #fafafa;}
    .tab-title { font-size: 1.5em; margin-bottom: 10px; color: #388e3c; font-weight: bold;}
    @media (max-width: 650px) {
      .cards { flex-direction: column; }
      header, .container { padding: 10px 5px; }
      #userPanel { float: none; margin-top: 0; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Ad 4 U</h1>
    <div id="userPanel"></div>
    <nav>
      <button onclick="showTab('dashboard')" id="tab-dashboard" class="active">Dashboard</button>
      <button onclick="showTab('webtraffic')" id="tab-webtraffic">Website Traffic</button>
      <button onclick="showTab('directlink')" id="tab-directlink">Direct Link</button>
      <button onclick="showTab('ytwatch')" id="tab-ytwatch">YT Watch Time</button>
      <button onclick="showTab('ytviews')" id="tab-ytviews">YT Views</button>
      <button onclick="showTab('referral')" id="tab-referral">Referral</button>
      <button onclick="showTab('adlaunch')" id="tab-adlaunch">Ad Launch</button>
    </nav>
  </header>

  <!-- Login/Signup Modal -->
  <div id="authModal" class="container" style="max-width:400px; margin-top:40px;">
    <h2 style="color:#2e7d32;">Login or Signup</h2>
    <button class="btn-action" onclick="googleLogin()">Sign in with Google</button>
    <div id="authErr" style="color:#d32f2f; margin-top:12px;"></div>
  </div>

  <div class="container" id="mainContent">
    <!-- Dashboard -->
    <div id="dashboard" class="">
      <div class="tab-title">Dashboard</div>
      <div class="cards">
        <div class="card">Total Coins: <span id="header-coins" class="highlight">0</span></div>
        <div class="card">W Coins: <span id="header-wcoins" class="highlight">0</span></div>
        <div class="card">D Coins: <span id="header-dcoins" class="highlight">0</span></div>
        <div class="card">YT Watch (h:m:s): <span id="header-watch" class="highlight">0:0:0</span></div>
        <div class="card">YT Views: <span id="header-views" class="highlight">0</span></div>
        <div class="card">Referral Earnings: <span id="header-referral" class="highlight">0</span></div>
      </div>
      <div style="margin:18px 0;">
        <b>Welcome to <span class="highlight">Ad 4 U</span>!</b> <br>
        <ul>
          <li><b>Run Ads Free and Paid!</b></li>
          <li>Want special country traffic? <b class="highlight">Use PC &amp; follow <a href="#" style="color:#d32f2f;text-decoration:underline;">this link instruction</a></b> to get any country traffic for your link.</li>
          <li><b>Earn coins by visiting ads, links, watching YouTube videos, and referring friends!</b></li>
          <li>Ad launch closes automatically after reaching budget or impressions.</li>
          <li>Earn <span class="highlight">15% lifetime referral commissions</span> from all invited users’ activities!</li>
          <li>Invite friends and get <span class="highlight">10,000 coins instantly</span> per referral!</li>
        </ul>
        <div id="randomInfo" style="background:#fffde7; padding:10px 14px; border-radius:6px; margin:12px 0; border:1px solid #ffe082;">
          <!-- Random info inserted here -->
        </div>
      </div>
    </div>

    <!-- Website Traffic -->
    <div id="webtraffic" class="hide">
      <div class="tab-title">Earn by Watching Website Ads</div>
      <div class="iframe-container">
        <iframe id="iframe-webtraffic" src="" allow="autoplay"></iframe>
      </div>
      <div class="timer">Time left: <span id="webtraffic-timer">15</span> sec</div>
      <button class="btn-action" id="webtraffic-next" onclick="nextWebAd()" disabled>Next Ad</button>
      <div style="margin:10px 0;">Earn <b>500 W Coins</b> per viewed ad!</div>
      <div>Your today’s earned coins: <span id="webtraffic-earned" class="highlight">0</span></div>
    </div>

    <!-- Direct Link -->
    <div id="directlink" class="hide">
      <div class="tab-title">Earn by Opening Direct Links</div>
      <div>
        <button class="btn-action" onclick="openDirectLink()">Open Next Direct Link</button>
      </div>
      <div style="margin:10px 0;">Earn <b>1000 D Coins</b> per link opened!</div>
      <div>Your today’s earned coins: <span id="directlink-earned" class="highlight">0</span></div>
    </div>

    <!-- Youtube Watch Time -->
    <div id="ytwatch" class="hide">
      <div class="tab-title">Earn by Watching YouTube Videos (Watch Time)</div>
      <div class="iframe-container">
        <iframe id="iframe-ytwatch" src="" allow="autoplay"></iframe>
      </div>
      <div class="timer">Earned: <span id="ytwatch-earned" class="highlight">0:0:0</span></div>
      <button class="btn-action" onclick="ytWatchPrev()">Prev</button>
      <button class="btn-action" onclick="ytWatchNext()">Next</button>
      <div style="margin-top:8px;">Watch to earn hours, minutes, seconds! Pausing stops earnings.</div>
    </div>

    <!-- Youtube Views -->
    <div id="ytviews" class="hide">
      <div class="tab-title">Earn by Watching YouTube Videos (Views)</div>
      <div class="iframe-container">
        <iframe id="iframe-ytviews" src="" allow="autoplay"></iframe>
      </div>
      <div class="timer">Views Earned: <span id="ytviews-earned" class="highlight">0</span></div>
      <button class="btn-action" onclick="ytViewsPrev()">Prev</button>
      <button class="btn-action" onclick="ytViewsNext()">Next</button>
      <div style="margin-top:8px;">Every 5s = 1 view! Pausing stops earnings.</div>
    </div>

    <!-- Referral -->
    <div id="referral" class="hide">
      <div class="tab-title">Referral Program</div>
      <div>
        <b>Invite friends and earn:</b>
        <ul>
          <li><span class="highlight">10,000 coins</span> per successful invite</li>
          <li><span class="highlight">15% lifetime commission</span> on friends’ earnings (web, direct, YT, etc.)</li>
        </ul>
        <div>Your Referral Link:</div>
        <div class="ref-link" id="ref-link"></div>
        <button class="btn-action" onclick="copyReferral()">Copy Referral Link</button>
      </div>
      <div style="margin-top:20px;">
        <b>Your Referred Friends &amp; Commissions</b>
        <table class="comm-table">
          <tr><th>Email</th><th>Earned</th><th>Commission (15%)</th></tr>
          <tbody id="ref-table"></tbody>
        </table>
      </div>
    </div>

    <!-- Ad Launch -->
    <div id="adlaunch" class="hide">
      <div class="tab-title">Launch Your Ad</div>
      <form id="adForm" onsubmit="return launchAd();">
        <div class="input-group">
          <label>Ad Type:</label>
          <select id="ad-type">
            <option value="web">Website Traffic</option>
            <option value="dlink">Direct Link</option>
            <option value="ytwatch">YT Watch Time</option>
            <option value="ytviews">YT Views</option>
          </select>
        </div>
        <div class="input-group">
          <label>Ad Link:</label>
          <input type="url" id="ad-link" required placeholder="https://your-ad-link.com" style="width:50%">
        </div>
        <div class="input-group">
          <label>Budget (coins):</label>
          <input type="number" id="ad-budget" required min="500" step="500" value="500">
        </div>
        <button type="submit" class="btn-action">Launch Ad</button>
      </form>
      <div id="adLaunchMsg" style="margin-top:14px; color:#388e3c;"></div>
      <div style="margin-top:20px;">
        <b>Your Running Ads</b>
        <ul id="running-ads"></ul>
      </div>
    </div>
  </div>

<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyAnu49G3ZZaMhRAYwoBPKfcRoj7sfcu5E8",
    authDomain: "ad-4-u.firebaseapp.com",
    projectId: "ad-4-u",
    storageBucket: "ad-4-u.appspot.com",
    messagingSenderId: "775864010731",
    appId: "1:775864010731:web:ea8a2ff4f772ca80ac3bae",
    measurementId: "G-3R9DDSM2XK"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  // State
  let user = null;
  let coins = 0, wcoins = 0, dcoins = 0, ytWatch = 0, ytViews = 0, referralEarned = 0;
  let referredFriends = [];
  let myAds = [];
  let referralId = "";
  // UI
  function showTab(tab) {
    for (let t of ['dashboard','webtraffic','directlink','ytwatch','ytviews','referral','adlaunch']) {
      document.getElementById(t).classList.add('hide');
      document.getElementById('tab-'+t).classList.remove('active');
    }
    document.getElementById(tab).classList.remove('hide');
    document.getElementById('tab-'+tab).classList.add('active');
  }
  // Random Info
  let randomDashboardTips = [
    "Tip: Invite more friends for more lifetime commission!",
    "Tip: Use PC for higher ad earning speed.",
    "All coins are usable for any ad type.",
    "You can use your referral coins to launch any ads.",
    "Pausing video or iframe pauses earnings.",
    "Auto ad rotation every 2 minutes for variety.",
    "Impressions are auto-counted based on budget."
  ];
  function updateRandomInfo() {
    let idx = Math.floor(Math.random()*randomDashboardTips.length);
    document.getElementById('randomInfo').innerText = randomDashboardTips[idx];
  }
  setInterval(updateRandomInfo, 15000); // Change tip every 15s
  updateRandomInfo();

  // Auth
  function googleLogin() {
    var provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider).catch(function(err){
      document.getElementById('authErr').innerText = err.message;
    });
  }
  function logout() {
    auth.signOut();
  }
  function updateUserPanel() {
    if (!user) {
      document.getElementById('userPanel').innerHTML = '';
      document.getElementById('mainContent').style.display = 'none';
      document.getElementById('authModal').style.display = '';
    } else {
      document.getElementById('userPanel').innerHTML = 
        `<span>${user.displayName || user.email}</span>
        <button onclick="logout()">Logout</button>`;
      document.getElementById('mainContent').style.display = '';
      document.getElementById('authModal').style.display = 'none';
      // Referral
      referralId = user.uid.slice(-6);
      document.getElementById('ref-link').innerText = window.location.origin + "/?ref=" + referralId;
    }
  }
  // Referral simulation
  function loadReferred() {
    // For demo: simulate 2 friends
    referredFriends = [
      {email:"friend1@gmail.com",earned:20000},
      {email:"friend2@gmail.com",earned:40000}
    ];
    let html = "";
    for (let f of referredFriends) {
      html += `<tr><td>${f.email}</td><td>${f.earned}</td><td>${Math.floor(f.earned*0.15)}</td></tr>`;
    }
    document.getElementById('ref-table').innerHTML = html;
    referralEarned = referredFriends.reduce((acc,f)=>acc+Math.floor(f.earned*0.15),0);
    updateHeader();
  }
  function copyReferral() {
    navigator.clipboard.writeText(document.getElementById('ref-link').innerText);
    alert("Referral link copied!");
  }

  // --- Coins, Header ---
  function updateHeader() {
    coins = wcoins + dcoins + referralEarned;
    document.getElementById('header-coins').innerText = coins;
    document.getElementById('header-wcoins').innerText = wcoins;
    document.getElementById('header-dcoins').innerText = dcoins;
    document.getElementById('header-watch').innerText = formatTime(ytWatch);
    document.getElementById('header-views').innerText = ytViews;
    document.getElementById('header-referral').innerText = referralEarned;
  }
  // --- Website Traffic ---
  const webAds = [
    "http://cludymovie.com/",
    "https://newswithsk.com/"
  ];
  let webAdIdx = 0, webAdTimer = 15, webAdInterval = null, webAdEarned=0;
  function loadWebAd() {
    document.getElementById('iframe-webtraffic').src = webAds[webAdIdx];
    webAdTimer = 15;
    document.getElementById('webtraffic-timer').innerText = webAdTimer;
    document.getElementById('webtraffic-next').disabled = true;
    if (webAdInterval) clearInterval(webAdInterval);
    webAdInterval = setInterval(()=>{
      webAdTimer--;
      document.getElementById('webtraffic-timer').innerText = webAdTimer;
      if (webAdTimer <= 0) {
        document.getElementById('webtraffic-next').disabled = false;
        clearInterval(webAdInterval);
        wcoins += 500;
        webAdEarned += 500;
        updateHeader();
        document.getElementById('webtraffic-earned').innerText = webAdEarned;
      }
    },1000);
  }
  function nextWebAd() {
    webAdIdx = (webAdIdx+1)%webAds.length;
    loadWebAd();
  }
  // Rotate ad every 2 min (120s)
  setInterval(()=>{
    if (!document.getElementById('webtraffic').classList.contains('hide')) nextWebAd();
  },120000);

  // --- Direct Link ---
  const directLinks = [
    "https://otieu.com/4/9677163",
    "https://otieu.com/4/9677163"
  ];
  let dlinkIdx = 0, dlinkEarned = 0;
  function openDirectLink() {
    window.open(directLinks[dlinkIdx],'_blank');
    dcoins += 1000;
    dlinkEarned += 1000;
    updateHeader();
    document.getElementById('directlink-earned').innerText = dlinkEarned;
    dlinkIdx = (dlinkIdx+1)%directLinks.length;
  }
  // --- YT Watch Time ---
  const ytLinks = [
    "https://www.youtube.com/embed/Uw9bqrrV-yI"
  ];
  let ytWatchIdx = 0, ytWatchTimer = null, ytWatchTime = 0, ytWatchRunning = false;
  function loadYtWatch() {
    document.getElementById('iframe-ytwatch').src = ytLinks[ytWatchIdx];
    ytWatchTime = 0;
    if (ytWatchTimer) clearInterval(ytWatchTimer);
    ytWatchRunning = true;
    ytWatchTimer = setInterval(()=>{
      if (ytWatchRunning) {
        ytWatchTime++;
        ytWatch++;
        updateHeader();
        document.getElementById('ytwatch-earned').innerText = formatTime(ytWatchTime);
      }
    },1000);
  }
  function ytWatchNext() {
    ytWatchIdx = (ytWatchIdx+1)%ytLinks.length;
    loadYtWatch();
  }
  function ytWatchPrev() {
    ytWatchIdx = (ytWatchIdx+ytLinks.length-1)%ytLinks.length;
    loadYtWatch();
  }
  // Pause on tab switch
  document.getElementById('ytwatch').addEventListener('mouseenter', ()=>{ytWatchRunning=true;});
  document.getElementById('ytwatch').addEventListener('mouseleave', ()=>{ytWatchRunning=false;});

  // --- YT Views ---
  let ytViewsIdx = 0, ytViewsTimer = null, ytViewsCount = 0, ytViewsRunning = false;
  function loadYtViews() {
    document.getElementById('iframe-ytviews').src = ytLinks[ytViewsIdx];
    ytViewsCount = 0;
    if (ytViewsTimer) clearInterval(ytViewsTimer);
    ytViewsRunning = true;
    ytViewsTimer = setInterval(()=>{
      if (ytViewsRunning) {
        ytViewsCount++;
        if (ytViewsCount % 5 === 0) {
          ytViews++;
          updateHeader();
          document.getElementById('ytviews-earned').innerText = ytViews;
        }
      }
    },1000);
  }
  function ytViewsNext() {
    ytViewsIdx = (ytViewsIdx+1)%ytLinks.length;
    loadYtViews();
  }
  function ytViewsPrev() {
    ytViewsIdx = (ytViewsIdx+ytLinks.length-1)%ytLinks.length;
    loadYtViews();
  }
  document.getElementById('ytviews').addEventListener('mouseenter', ()=>{ytViewsRunning=true;});
  document.getElementById('ytviews').addEventListener('mouseleave', ()=>{ytViewsRunning=false;});

  // --- Ad Launch ---
  function launchAd() {
    let type = document.getElementById('ad-type').value;
    let link = document.getElementById('ad-link').value;
    let budget = parseInt(document.getElementById('ad-budget').value||"0");
    let minCost = (type=='web')?500:((type=='dlink')?1000:((type=='ytwatch')?100:100));
    if (budget < minCost) {
      document.getElementById('adLaunchMsg').style.color = '#d32f2f';
      document.getElementById('adLaunchMsg').innerText = 'Insufficient budget!';
      return false;
    }
    if (budget > coins) {
      document.getElementById('adLaunchMsg').style.color = '#d32f2f';
      document.getElementById('adLaunchMsg').innerText = 'Not enough coins!';
      return false;
    }
    coins -= budget;
    updateHeader();
    myAds.push({type,link,budget,active:true,spent:0});
    document.getElementById('adLaunchMsg').style.color = '#388e3c';
    document.getElementById('adLaunchMsg').innerText = 'Ad launched successfully!';
    updateAdsList();
    return false;
  }
  function updateAdsList() {
    let html = "";
    for (let ad of myAds) {
      html += `<li>${ad.type.toUpperCase()} - <a href="${ad.link}" target="_blank">${ad.link}</a> | Budget: ${ad.budget} | Status: <span style="color:${ad.active?'#388e3c':'#d32f2f'}">${ad.active?'Active':'Expired'}</span></li>`;
    }
    document.getElementById('running-ads').innerHTML = html;
  }

  // --- Utility ---
  function formatTime(sec) {
    return Math.floor(sec/3600) + ":" + Math.floor((sec%3600)/60) + ":" + (sec%60);
  }

  // Auth State
  auth.onAuthStateChanged(function(u) {
    user = u;
    updateUserPanel();
    if (user) {
      // simulate loading coins, earnings, referrals
      loadReferred();
      updateHeader();
      // load ad links
      loadWebAd();
      loadYtWatch();
      loadYtViews();
    }
  });
  // Auto show/hide main content
  window.onload = function() {
    updateUserPanel();
    showTab('dashboard');
  }
</script>
</body>
</html>
